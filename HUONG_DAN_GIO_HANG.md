# ğŸ›’ HÆ°á»›ng dáº«n sá»­ dá»¥ng chá»©c nÄƒng Giá» hÃ ng - UTESHOP

## ğŸ“‹ Tá»•ng quan

Chá»©c nÄƒng giá» hÃ ng Ä‘Ã£ Ä‘Æ°á»£c triá»ƒn khai hoÃ n chá»‰nh vá»›i Ä‘áº§y Ä‘á»§ cÃ¡c tÃ­nh nÄƒng cáº§n thiáº¿t cho má»™t website thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­ hiá»‡n Ä‘áº¡i.

### âœ¨ CÃ¡c tÃ­nh nÄƒng chÃ­nh

- âœ… **ThÃªm sáº£n pháº©m vÃ o giá» hÃ ng** - Tá»« trang chi tiáº¿t hoáº·c nÃºt nhanh trÃªn card sáº£n pháº©m
- âœ… **Cáº­p nháº­t sá»‘ lÆ°á»£ng** - TÄƒng/giáº£m sá»‘ lÆ°á»£ng sáº£n pháº©m trong giá»
- âœ… **XÃ³a sáº£n pháº©m** - XÃ³a tá»«ng sáº£n pháº©m hoáº·c xÃ³a toÃ n bá»™ giá» hÃ ng
- âœ… **Hiá»ƒn thá»‹ real-time** - Badge sá»‘ lÆ°á»£ng sáº£n pháº©m tá»± Ä‘á»™ng cáº­p nháº­t
- âœ… **Kiá»ƒm tra tá»“n kho** - Tá»± Ä‘á»™ng kiá»ƒm tra sá»‘ lÆ°á»£ng cÃ³ sáºµn
- âœ… **YÃªu cáº§u Ä‘Äƒng nháº­p** - Báº£o máº­t vÃ  quáº£n lÃ½ giá» hÃ ng theo user
- âœ… **Giao diá»‡n Ä‘áº¹p** - UI/UX hiá»‡n Ä‘áº¡i vá»›i Bootstrap 5

---

## ğŸ¯ CÃ¡ch sá»­ dá»¥ng cho ngÆ°á»i dÃ¹ng cuá»‘i

### 1. ThÃªm sáº£n pháº©m vÃ o giá» hÃ ng

#### **CÃ¡ch 1: Tá»« trang chá»§ hoáº·c danh sÃ¡ch sáº£n pháº©m**
1. Hover chuá»™t vÃ o card sáº£n pháº©m
2. Click vÃ o nÃºt giá» hÃ ng (icon giá» hÃ ng) xuáº¥t hiá»‡n á»Ÿ gÃ³c pháº£i dÆ°á»›i
3. ThÃ´ng bÃ¡o thÃ nh cÃ´ng sáº½ hiá»‡n ra
4. Badge sá»‘ lÆ°á»£ng trÃªn icon giá» hÃ ng (header) sáº½ tá»± Ä‘á»™ng cáº­p nháº­t

![Quick Add Demo](assets/quick-add-demo.gif)

#### **CÃ¡ch 2: Tá»« trang chi tiáº¿t sáº£n pháº©m**
1. Truy cáº­p vÃ o trang chi tiáº¿t sáº£n pháº©m
2. Chá»n sá»‘ lÆ°á»£ng muá»‘n mua
3. Click nÃºt **"ThÃªm vÃ o giá» hÃ ng"**
4. ThÃ´ng bÃ¡o thÃ nh cÃ´ng vÃ  badge cáº­p nháº­t

![Detail Page Add](assets/detail-add-demo.gif)

### 2. Xem giá» hÃ ng

- Click vÃ o icon giá» hÃ ng á»Ÿ header
- Hoáº·c truy cáº­p: `http://localhost:8080/UTESHOP/cart`

### 3. Quáº£n lÃ½ giá» hÃ ng

Trong trang giá» hÃ ng, báº¡n cÃ³ thá»ƒ:

- **TÄƒng/giáº£m sá»‘ lÆ°á»£ng**: Sá»­ dá»¥ng nÃºt +/- bÃªn cáº¡nh má»—i sáº£n pháº©m
- **XÃ³a sáº£n pháº©m**: Click icon thÃ¹ng rÃ¡c
- **XÃ³a toÃ n bá»™**: Click nÃºt "XÃ³a táº¥t cáº£" (náº¿u cÃ³)
- **Xem tá»•ng tiá»n**: Hiá»ƒn thá»‹ tá»± Ä‘á»™ng á»Ÿ panel bÃªn pháº£i

### 4. LÆ°u Ã½ quan trá»ng âš ï¸

- âš ï¸ **Pháº£i Ä‘Äƒng nháº­p** trÆ°á»›c khi thÃªm sáº£n pháº©m vÃ o giá» hÃ ng
- âš ï¸ Sá»‘ lÆ°á»£ng thÃªm **khÃ´ng Ä‘Æ°á»£c vÆ°á»£t quÃ¡** sá»‘ lÆ°á»£ng tá»“n kho
- âš ï¸ Giá» hÃ ng Ä‘Æ°á»£c **lÆ°u theo user**, khÃ´ng bá»‹ máº¥t khi Ä‘Äƒng xuáº¥t
- âš ï¸ ThÃ´ng bÃ¡o lá»—i sáº½ hiá»‡n náº¿u sáº£n pháº©m háº¿t hÃ ng hoáº·c vÆ°á»£t quÃ¡ tá»“n kho

---

## ğŸ› ï¸ Cáº¥u trÃºc ká»¹ thuáº­t

### ğŸ“ Cáº¥u trÃºc thÆ° má»¥c

```
UTESHOP/
â”œâ”€â”€ src/main/java/ute/
â”‚   â”œâ”€â”€ entities/
â”‚   â”‚   â”œâ”€â”€ Cart.java              # Entity giá» hÃ ng
â”‚   â”‚   â”œâ”€â”€ CartDetail.java        # Entity chi tiáº¿t giá» hÃ ng
â”‚   â”‚   â””â”€â”€ Product.java           # Entity sáº£n pháº©m
â”‚   â”‚
â”‚   â”œâ”€â”€ dao/
â”‚   â”‚   â”œâ”€â”€ inter/CartDao.java     # Interface DAO
â”‚   â”‚   â””â”€â”€ impl/CartDaoImpl.java  # Implementation DAO
â”‚   â”‚
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â”œâ”€â”€ inter/CartService.java     # Interface Service
â”‚   â”‚   â””â”€â”€ impl/CartServiceImpl.java  # Business logic
â”‚   â”‚
â”‚   â””â”€â”€ controllers/
â”‚       â”œâ”€â”€ api/CartApiController.java  # REST API endpoints
â”‚       â””â”€â”€ web/CartController.java     # Web controller
â”‚
â””â”€â”€ src/main/webapp/
    â”œâ”€â”€ WEB-INF/views/web/
    â”‚   â”œâ”€â”€ cart.jsp              # Trang giá» hÃ ng
    â”‚   â”œâ”€â”€ detailProduct.jsp     # Trang chi tiáº¿t sáº£n pháº©m
    â”‚   â”œâ”€â”€ home.jsp              # Trang chá»§
    â”‚   â”œâ”€â”€ filter.jsp            # Trang lá»c sáº£n pháº©m
    â”‚   â””â”€â”€ product-card.jsp      # Component card sáº£n pháº©m
    â”‚
    â””â”€â”€ assets/js/
        â””â”€â”€ cart.js               # JavaScript functions
```

### ğŸ”— API Endpoints

| Method | Endpoint | MÃ´ táº£ |
|--------|----------|-------|
| GET | `/api/cart` | Láº¥y thÃ´ng tin giá» hÃ ng (tá»•ng giÃ¡, sá»‘ lÆ°á»£ng) |
| GET | `/api/cart/count` | Láº¥y sá»‘ lÆ°á»£ng sáº£n pháº©m trong giá» |
| POST | `/api/cart/add` | ThÃªm sáº£n pháº©m vÃ o giá» hÃ ng |
| POST | `/api/cart/update` | Cáº­p nháº­t sá»‘ lÆ°á»£ng sáº£n pháº©m |
| POST | `/api/cart/remove` | XÃ³a sáº£n pháº©m khá»i giá» hÃ ng |
| POST | `/api/cart/clear` | XÃ³a toÃ n bá»™ giá» hÃ ng |

### ğŸ“ API Request/Response Format

#### **POST /api/cart/add**
```json
// Request
{
  "productId": 123,
  "quantity": 2
}

// Response - Success
{
  "success": true,
  "message": "ÄÃ£ thÃªm sáº£n pháº©m vÃ o giá» hÃ ng",
  "itemCount": 5
}

// Response - Error
{
  "success": false,
  "error": "Not enough stock. Available: 10"
}
```

#### **POST /api/cart/update**
```json
// Request
{
  "cartDetailId": 456,
  "quantity": 3
}

// Response
{
  "success": true,
  "message": "ÄÃ£ cáº­p nháº­t sá»‘ lÆ°á»£ng",
  "itemCount": 6
}
```

#### **POST /api/cart/remove**
```json
// Request
{
  "cartDetailId": 456
}

// Response
{
  "success": true,
  "message": "ÄÃ£ xÃ³a sáº£n pháº©m khá»i giá» hÃ ng",
  "itemCount": 4
}
```

#### **GET /api/cart/count**
```json
// Response
{
  "success": true,
  "count": 5
}
```

---

## ğŸ”§ HÆ°á»›ng dáº«n cho Developer

### 1. Sá»­ dá»¥ng JavaScript Functions

File `cart.js` cung cáº¥p cÃ¡c functions toÃ n cá»¥c:

```javascript
// ThÃªm sáº£n pháº©m vÃ o giá» hÃ ng
addToCart(productId, quantity);

// Cáº­p nháº­t sá»‘ lÆ°á»£ng
updateCartQuantity(cartDetailId, quantity);

// XÃ³a sáº£n pháº©m
removeFromCart(cartDetailId);

// XÃ³a táº¥t cáº£
clearCart();

// Láº¥y sá»‘ lÆ°á»£ng sáº£n pháº©m
getCartCount();

// Cáº­p nháº­t badge sá»‘ lÆ°á»£ng
updateCartCount(count);

// Hiá»ƒn thá»‹ thÃ´ng bÃ¡o
showNotification(message, type);  // type: success, error, warning, info
```

### 2. ThÃªm nÃºt "ThÃªm vÃ o giá» hÃ ng" trong JSP

#### **CÃ¡ch 1: Sá»­ dá»¥ng component card sáº£n pháº©m**
```jsp
<c:forEach var="p" items="${products}">
    <div class="col-md-3">
        <jsp:include page="product-card.jsp" />
    </div>
</c:forEach>

<!-- Äá»«ng quÃªn include cart.js -->
<script src="${pageContext.request.contextPath}/assets/js/cart.js"></script>
```

#### **CÃ¡ch 2: Custom button**
```jsp
<!-- NÃºt vá»›i onclick -->
<button class="btn btn-primary" 
        onclick="addToCart(${product.productID}, 1)">
    <i class="bi bi-cart-plus"></i> ThÃªm vÃ o giá» hÃ ng
</button>

<!-- NÃºt vá»›i data attributes -->
<button class="btn btn-primary btn-add-to-cart" 
        data-product-id="${product.productID}" 
        data-quantity="1">
    <i class="bi bi-cart-plus"></i> ThÃªm vÃ o giá» hÃ ng
</button>

<!-- Include cart.js Ä‘á»ƒ auto-bind events -->
<script src="${pageContext.request.contextPath}/assets/js/cart.js"></script>
```

### 3. TÃ¹y chá»‰nh component product-card.jsp

Component `product-card.jsp` Ä‘Ã£ Ä‘Æ°á»£c táº¡o sáºµn vá»›i:
- áº¢nh sáº£n pháº©m
- TÃªn vÃ  giÃ¡ sáº£n pháº©m
- NÃºt "ThÃªm vÃ o giá» hÃ ng" xuáº¥t hiá»‡n khi hover
- Link Ä‘áº¿n trang chi tiáº¿t

Báº¡n cÃ³ thá»ƒ tÃ¹y chá»‰nh style trong file hoáº·c override CSS:

```css
.product-card:hover .btn-quick-add {
    opacity: 1 !important;
}

.product-card:hover {
    transform: translateY(-5px);
}
```

### 4. Xá»­ lÃ½ lá»—i vÃ  validation

Service layer tá»± Ä‘á»™ng xá»­ lÃ½:
- âœ… Kiá»ƒm tra user Ä‘Ã£ Ä‘Äƒng nháº­p
- âœ… Kiá»ƒm tra product tá»“n táº¡i
- âœ… Kiá»ƒm tra tá»“n kho
- âœ… Merge sáº£n pháº©m trÃ¹ng láº·p
- âœ… TÃ­nh tá»•ng giÃ¡ tá»± Ä‘á»™ng

```java
// CartServiceImpl.java
@Override
public void addToCart(Long userId, Long productId, int quantity) {
    // Validation
    if (quantity <= 0) {
        throw new IllegalArgumentException("Quantity must be greater than 0");
    }
    
    // Kiá»ƒm tra tá»“n kho
    if (product.getStockQuantity() < quantity) {
        throw new RuntimeException("Not enough stock. Available: " + product.getStockQuantity());
    }
    
    // Merge náº¿u sáº£n pháº©m Ä‘Ã£ tá»“n táº¡i
    // ...
}
```

---

## ğŸ“Š Database Schema

### Table: Cart
```sql
CREATE TABLE Cart (
    cartID BIGINT PRIMARY KEY IDENTITY(1,1),
    userID BIGINT FOREIGN KEY REFERENCES Users(userID),
    totalPrice FLOAT
);
```

### Table: CartDetail
```sql
CREATE TABLE CartDetail (
    cartDetailID BIGINT PRIMARY KEY IDENTITY(1,1),
    cartID BIGINT FOREIGN KEY REFERENCES Cart(cartID),
    productID BIGINT FOREIGN KEY REFERENCES Product(productID),
    quantity INT,
    unitPrice FLOAT
);
```

### Relationships
- **Cart** â†” **Users**: One-to-One
- **Cart** â†” **CartDetail**: One-to-Many
- **CartDetail** â†” **Product**: Many-to-One

---

## ğŸ§ª Testing

### Test Cases

#### 1. Test thÃªm sáº£n pháº©m vÃ o giá» hÃ ng
âœ… User chÆ°a Ä‘Äƒng nháº­p â†’ Hiá»ƒn thá»‹ modal Ä‘Äƒng nháº­p  
âœ… ThÃªm sáº£n pháº©m má»›i â†’ Táº¡o CartDetail má»›i  
âœ… ThÃªm sáº£n pháº©m Ä‘Ã£ cÃ³ â†’ Cá»™ng dá»“n sá»‘ lÆ°á»£ng  
âœ… VÆ°á»£t quÃ¡ tá»“n kho â†’ Hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i  
âœ… Badge cáº­p nháº­t real-time  

#### 2. Test cáº­p nháº­t sá»‘ lÆ°á»£ng
âœ… TÄƒng sá»‘ lÆ°á»£ng â†’ Kiá»ƒm tra tá»“n kho  
âœ… Giáº£m sá»‘ lÆ°á»£ng â†’ Cáº­p nháº­t thÃ nh cÃ´ng  
âœ… Set vá» 0 â†’ XÃ³a sáº£n pháº©m  
âœ… Tá»•ng giÃ¡ cáº­p nháº­t Ä‘Ãºng  

#### 3. Test xÃ³a sáº£n pháº©m
âœ… XÃ³a tá»«ng sáº£n pháº©m â†’ Badge giáº£m  
âœ… XÃ³a toÃ n bá»™ â†’ Giá» hÃ ng trá»‘ng  
âœ… Confirm trÆ°á»›c khi xÃ³a  

### Manual Testing

```bash
# 1. Start server
cd UTESHOP
mvn clean tomcat7:run

# 2. Truy cáº­p
http://localhost:8080/UTESHOP/

# 3. Test flow
- ÄÄƒng nháº­p
- ThÃªm sáº£n pháº©m tá»« trang chá»§ (hover vÃ  click icon giá»)
- Kiá»ƒm tra badge cáº­p nháº­t
- VÃ o trang giá» hÃ ng (/cart)
- TÄƒng/giáº£m sá»‘ lÆ°á»£ng
- XÃ³a sáº£n pháº©m
```

---

## ğŸš€ CÃ¡c tÃ­nh nÄƒng Ä‘Ã£ triá»ƒn khai

### âœ… HoÃ n thÃ nh
- [x] Entity classes (Cart, CartDetail)
- [x] DAO layer (CartDao, CartDaoImpl)
- [x] Service layer (CartService, CartServiceImpl)
- [x] API Controller (REST endpoints)
- [x] Web Controller (trang giá» hÃ ng)
- [x] JavaScript functions (cart.js)
- [x] UI/UX trang giá» hÃ ng (cart.jsp)
- [x] Component card sáº£n pháº©m vá»›i quick add (product-card.jsp)
- [x] TÃ­ch há»£p vÃ o trang chá»§ (home.jsp)
- [x] TÃ­ch há»£p vÃ o trang lá»c (filter.jsp)
- [x] TÃ­ch há»£p vÃ o trang chi tiáº¿t (detailProduct.jsp)
- [x] Header badge hiá»ƒn thá»‹ sá»‘ lÆ°á»£ng
- [x] Auto-update cart count
- [x] Notification system
- [x] Authentication check
- [x] Stock validation

### ğŸ”œ CÃ³ thá»ƒ má»Ÿ rá»™ng
- [ ] Coupon/Discount system
- [ ] Guest cart (lÆ°u vÃ o session/cookie)
- [ ] Order from cart (checkout flow)
- [ ] Save for later
- [ ] Recently viewed products
- [ ] Cart sharing
- [ ] Email cart to customer

---

## ğŸ¨ Screenshots

### Trang chá»§ vá»›i nÃºt Quick Add
![Home Page](screenshots/home.png)

### Trang giá» hÃ ng
![Cart Page](screenshots/cart.png)

### ThÃ´ng bÃ¡o thÃ nh cÃ´ng
![Notification](screenshots/notification.png)

### Badge cáº­p nháº­t
![Badge Update](screenshots/badge.png)

---

## â“ Troubleshooting

### Lá»—i: "Vui lÃ²ng Ä‘Äƒng nháº­p"
**NguyÃªn nhÃ¢n**: User chÆ°a Ä‘Äƒng nháº­p  
**Giáº£i phÃ¡p**: ÄÄƒng nháº­p trÆ°á»›c khi thÃªm vÃ o giá» hÃ ng

### Lá»—i: "Not enough stock"
**NguyÃªn nhÃ¢n**: Sá»‘ lÆ°á»£ng yÃªu cáº§u > tá»“n kho  
**Giáº£i phÃ¡p**: Giáº£m sá»‘ lÆ°á»£ng hoáº·c chá»n sáº£n pháº©m khÃ¡c

### Badge khÃ´ng cáº­p nháº­t
**NguyÃªn nhÃ¢n**: cart.js chÆ°a Ä‘Æ°á»£c load  
**Giáº£i phÃ¡y**: Kiá»ƒm tra Ä‘Ã£ include cart.js trong trang

### NÃºt Quick Add khÃ´ng hiá»‡n
**NguyÃªn nhÃ¢n**: ChÆ°a hover vÃ o card hoáº·c CSS lá»—i  
**Giáº£i phÃ¡p**: Hover vÃ o card hoáº·c check CSS cá»§a `.btn-quick-add`

### API tráº£ vá» 401 Unauthorized
**NguyÃªn nhÃ¢n**: Session háº¿t háº¡n hoáº·c chÆ°a Ä‘Äƒng nháº­p  
**Giáº£i phÃ¡p**: ÄÄƒng nháº­p láº¡i

---

## ğŸ“ Há»— trá»£

Náº¿u gáº·p váº¥n Ä‘á» hoáº·c cÃ³ cÃ¢u há»i, vui lÃ²ng:
1. Kiá»ƒm tra console log (F12 â†’ Console)
2. Kiá»ƒm tra Network tab (F12 â†’ Network)
3. Äá»c ká»¹ thÃ´ng bÃ¡o lá»—i
4. Tham kháº£o file `CART_GUIDE.md` gá»‘c
5. LiÃªn há»‡ team phÃ¡t triá»ƒn

---

## ğŸ“ Changelog

### Version 2.0 (Current)
- âœ¨ ThÃªm component product-card.jsp vá»›i nÃºt Quick Add
- âœ¨ TÃ­ch há»£p Quick Add vÃ o trang chá»§
- âœ¨ TÃ­ch há»£p Quick Add vÃ o trang filter
- âœ¨ Cáº£i thiá»‡n UI/UX vá»›i hover effects
- âœ¨ Tá»‘i Æ°u hÃ³a cart.js
- ğŸ› Sá»­a lá»—i endpoint trong detailProduct.jsp
- ğŸ“š Táº¡o tÃ i liá»‡u hÆ°á»›ng dáº«n chi tiáº¿t

### Version 1.0
- ğŸ‰ Release chá»©c nÄƒng giá» hÃ ng cÆ¡ báº£n
- API endpoints hoÃ n chá»‰nh
- Trang giá» hÃ ng vá»›i Bootstrap 5
- JavaScript utilities

---

## ğŸ“ Best Practices

### Khi sá»­ dá»¥ng
1. **LuÃ´n kiá»ƒm tra Ä‘Äƒng nháº­p** trÆ°á»›c khi cho phÃ©p thao tÃ¡c
2. **Validate input** á»Ÿ cáº£ client vÃ  server
3. **Hiá»ƒn thá»‹ feedback** rÃµ rÃ ng cho user
4. **Handle errors** gracefully
5. **Optimize performance** vá»›i caching náº¿u cáº§n

### Khi phÃ¡t triá»ƒn thÃªm
1. **Follow naming conventions** Ä‘Ã£ cÃ³
2. **Reuse components** (nhÆ° product-card.jsp)
3. **Document code** rÃµ rÃ ng
4. **Test thoroughly** trÆ°á»›c khi merge
5. **Keep it simple** - Ä‘á»«ng over-engineer

---

**ChÃºc báº¡n sá»­ dá»¥ng thÃ nh cÃ´ng! ğŸ‰**

*TÃ i liá»‡u nÃ y Ä‘Æ°á»£c cáº­p nháº­t láº§n cuá»‘i: ${new java.util.Date()}*

