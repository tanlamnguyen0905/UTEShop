<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Debug Phone Issue</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #f5f5f5; }
        .section { background: white; padding: 20px; margin: 10px 0; border-radius: 8px; }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
        pre { background: #f0f0f0; padding: 10px; overflow-x: auto; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        input { padding: 8px; margin: 5px 0; width: 300px; }
    </style>
</head>
<body>
    <h1>üîç Debug Address Phone Issue</h1>
    
    <div class="section">
        <h2>Th√¥ng tin hi·ªán t·∫°i</h2>
        <p>‚úÖ ƒê·ªãa ch·ªâ th·ª© 2 c√≥ phone: <span class="success">0915677076</span></p>
        <p>‚ùå ƒê·ªãa ch·ªâ th·ª© 1 kh√¥ng c√≥ phone</p>
    </div>
    
    <div class="section">
        <h2>Test 1: Ki·ªÉm tra Form</h2>
        <p>V√†o trang profile v√† m·ªü Console (F12), paste code n√†y:</p>
        <pre>// Ki·ªÉm tra phone input c√≥ t·ªìn t·∫°i kh√¥ng
console.log('Phone input:', document.getElementById('phone'));
console.log('Phone value:', document.getElementById('phone')?.value);

// Ki·ªÉm tra form data khi submit
const form = document.getElementById('addressForm');
if (form) {
    console.log('Form exists:', form);
} else {
    console.error('Form NOT found!');
}</pre>
    </div>
    
    <div class="section">
        <h2>Test 2: S·ª≠a ƒë·ªãa ch·ªâ th·ª© nh·∫•t</h2>
        <ol>
            <li>Click n√∫t "S·ª≠a" (icon b√∫t ch√¨) ·ªü ƒë·ªãa ch·ªâ "folders"</li>
            <li>Form s·∫Ω m·ªü ra, ki·ªÉm tra √¥ "S·ªë ƒëi·ªán tho·∫°i" c√≥ gi√° tr·ªã kh√¥ng</li>
            <li>Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i: <code>0987654321</code></li>
            <li>Click "L∆∞u ƒë·ªãa ch·ªâ"</li>
            <li>Ki·ªÉm tra Console log:
                <pre>Editing address: 1 {name: "folders", phone: "", ...}
Submitting address: {name: "folders", phone: "0987654321", ...}
=== DEBUG ADDRESS UPDATE ===
...
Address saved successfully: ...</pre>
            </li>
        </ol>
    </div>
    
    <div class="section">
        <h2>Test 3: Ki·ªÉm tra API tr·ª±c ti·∫øp</h2>
        <p>M·ªü Console v√† paste:</p>
        <pre>// Get all addresses
const token = localStorage.getItem('authToken');
fetch('http://localhost:8080/UTESHOP/api/user/addresses', {
    headers: { 'Authorization': 'Bearer ' + token }
})
.then(r => r.json())
.then(data => {
    console.log('All addresses:', data);
    data.data.forEach(addr => {
        console.log(`- ${addr.name}: phone = ${addr.phone || 'NULL'}`);
    });
});</pre>
    </div>
    
    <div class="section">
        <h2>Test 4: Update tr·ª±c ti·∫øp qua API</h2>
        <p>M·ªü Console v√† paste (thay ADDRESS_ID = 1):</p>
        <pre>// Update address #1 v·ªõi phone
const ADDRESS_ID = 1; // ‚Üê Thay b·∫±ng addressID c·ªßa ƒë·ªãa ch·ªâ "folders"
const token = localStorage.getItem('authToken');

fetch(`http://localhost:8080/UTESHOP/api/user/addresses/${ADDRESS_ID}`, {
    method: 'PUT',
    headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer ' + token
    },
    body: JSON.stringify({
        name: "folders",
        phone: "0999888777", // ‚Üê S·ªë ƒëi·ªán tho·∫°i m·ªõi
        province: "H√≤a B·∫Øc",
        district: "Di Linh",
        ward: "L√¢m ƒê·ªìng",
        addressDetail: "123",
        isDefault: true
    })
})
.then(r => r.json())
.then(data => {
    console.log('Update result:', data);
    if (data.success) {
        console.log('‚úÖ Phone updated:', data.data.phone);
        alert('Success! Phone = ' + data.data.phone);
        location.reload(); // Reload trang ƒë·ªÉ xem k·∫øt qu·∫£
    } else {
        console.error('‚ùå Failed:', data.error);
    }
});</pre>
    </div>
    
    <div class="section">
        <h2>Gi·∫£i ph√°p nhanh: Update database tr·ª±c ti·∫øp</h2>
        <p>Ch·∫°y SQL trong SQL Server Management Studio:</p>
        <pre>-- Xem ƒë·ªãa ch·ªâ n√†o kh√¥ng c√≥ phone
SELECT addressID, name, phone, province
FROM Addresses
WHERE phone IS NULL OR phone = '';

-- Update ƒë·ªãa ch·ªâ ID = 1 (thay ID t∆∞∆°ng ·ª©ng)
UPDATE Addresses
SET phone = '0909123456'
WHERE addressID = 1;

-- Ki·ªÉm tra l·∫°i
SELECT addressID, name, phone, province
FROM Addresses
ORDER BY addressID;</pre>
    </div>
    
    <div class="section">
        <h2>Checklist Debug</h2>
        <ul>
            <li>‚òê Database c√≥ c·ªôt <code>phone</code> trong b·∫£ng <code>Addresses</code></li>
            <li>‚òê Form c√≥ input <code>id="phone"</code></li>
            <li>‚òê Console log hi·ªÉn th·ªã phone khi submit</li>
            <li>‚òê API response tr·∫£ v·ªÅ phone</li>
            <li>‚òê Database query cho th·∫•y phone ƒë∆∞·ª£c l∆∞u</li>
            <li>‚òê JSP hi·ªÉn th·ªã <code>${addr.phone}</code> ƒë√∫ng</li>
        </ul>
    </div>
    
    <div class="section">
        <h2>K·∫øt lu·∫≠n</h2>
        <p class="success">‚úÖ Code ƒë√£ ho·∫°t ƒë·ªông - ƒë·ªãa ch·ªâ th·ª© 2 ƒë√£ c√≥ phone!</p>
        <p>‚ùå ƒê·ªãa ch·ªâ th·ª© 1 l√† d·ªØ li·ªáu c≈© (t·∫°o tr∆∞·ªõc khi c√≥ feature phone)</p>
        <p><strong>Gi·∫£i ph√°p:</strong> S·ª≠a l·∫°i ƒë·ªãa ch·ªâ th·ª© 1 qua UI ho·∫∑c update database tr·ª±c ti·∫øp</p>
    </div>
    
    <script>
        console.log('üìã Debug guide loaded. Follow the tests above!');
    </script>
</body>
</html>


